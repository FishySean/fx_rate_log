<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exchange Rates</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script> <!-- 引入 Chart.js 库 -->
</head>
<body>
    <h1>CNY/USD Exchange Rate Comparison</h1>
    
    <canvas id="exchangeRateChart" width="400" height="200"></canvas> <!-- Chart.js 的画布 -->

    <script>
        // 从后端获取数据
        fetch('/rates_data')
        .then(response => response.json())
        .then(data => {
            const times = data.times;

            // 招商银行汇率
            const cmb_rtbBid = data.cmb_rtbBid;  // 综合汇率
            const cmb_rtcBid = data.cmb_rtcBid;  // 现钞买入价
            const cmb_rtcOfr = data.cmb_rtcOfr;  // 现钞卖出价
            const cmb_rthOfr = data.cmb_rthOfr;  // 现汇卖出价
            const cmb_rtbOfr = data.cmb_rtbOfr;  // 现汇买入价

            // 中国银行汇率
            const boc_rtbBid = data.boc_rtbBid;  // 综合汇率
            const boc_rtcBid = data.boc_rtcBid;  // 现钞买入价
            const boc_rtcOfr = data.boc_rtcOfr;  // 现钞卖出价
            const boc_rthOfr = data.boc_rthOfr;  // 现汇卖出价
            const boc_rtbOfr = data.boc_rtbOfr;  // 现汇买入价

            // 使用 Chart.js 渲染图表
            const ctx = document.getElementById('exchangeRateChart').getContext('2d');
            const exchangeRateChart = new Chart(ctx, {
                type: 'line',  // 折线图
                data: {
                    labels: times,  // 时间标签
                    datasets: [
                        // 招商银行数据集
                        {
                            label: '招商银行综合汇率',
                            data: cmb_rtbBid,
                            borderColor: 'rgba(75, 192, 192, 1)',
                            fill: false
                        },
                        {
                            label: '招商银行现钞买入价',
                            data: cmb_rtcBid,
                            borderColor: 'rgba(75, 192, 192, 0.7)',
                            fill: false
                        },
                        {
                            label: '招商银行现钞卖出价',
                            data: cmb_rtcOfr,
                            borderColor: 'rgba(75, 192, 192, 0.5)',
                            fill: false
                        },
                        {
                            label: '招商银行现汇卖出价',
                            data: cmb_rthOfr,
                            borderColor: 'rgba(75, 192, 192, 0.3)',
                            fill: false
                        },
                        {
                            label: '招商银行现汇买入价',
                            data: cmb_rtbOfr,
                            borderColor: 'rgba(75, 192, 192, 0.1)',
                            fill: false
                        },

                        // 中国银行数据集
                        {
                            label: '中国银行综合汇率',
                            data: boc_rtbBid,
                            borderColor: 'rgba(255, 99, 132, 1)',
                            fill: false
                        },
                        {
                            label: '中国银行现钞买入价',
                            data: boc_rtcBid,
                            borderColor: 'rgba(255, 99, 132, 0.7)',
                            fill: false
                        },
                        {
                            label: '中国银行现钞卖出价',
                            data: boc_rtcOfr,
                            borderColor: 'rgba(255, 99, 132, 0.5)',
                            fill: false
                        },
                        {
                            label: '中国银行现汇卖出价',
                            data: boc_rthOfr,
                            borderColor: 'rgba(255, 99, 132, 0.3)',
                            fill: false
                        },
                        {
                            label: '中国银行现汇买入价',
                            data: boc_rtbOfr,
                            borderColor: 'rgba(255, 99, 132, 0.1)',
                            fill: false
                        }
                    ]
                },
                options: {
                    responsive: true,
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: '时间'
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: '汇率 (人民币/美元)'
                            },
                            beginAtZero: false
                        }
                    }
                }
            });
        })
        .catch(error => console.error('Error fetching data:', error));
    </script>
</body>
</html>
